<template name="Parties">
    <div class="toolbarForm">
        <ul>
            <li><button id="retour">{{_ "interface.bouton.retour" }}</button></li>
        </ul>
    </div>
    <div class="listParties">
    {{#each parties}}
        {{> PartieItem }}       
    {{/each}}
    </div>
</template>
<template name="PartieItem">
    <div class="partie">
        <div class="illustrationPartie"></div>
        <div class="infosPartie">
            <div class="titrePartie"><button class="lien" data-partieId="{{ _id }}"  data-scenarioId="{{ scenarioId }}">{{nom}}</button></div>
            <div class="descPartie">{{scenario.intitule}}</div>
            <div class="tagsPartie">
                <span class="tagPartie">{{_ "interface.budget" }}: {{convertir deck.budget "EUR"}}€</span>
                {{#if cubesat }}
                    <span class="tagPartie">{{_ "interface.cubesat" }}: ({{_ "interface.poidsMax"}}: {{scenario.initialisation.cubesatLimites.poidsMax}}gr, {{_ "interface.volumeMax"}}: {{scenario.initialisation.cubesatLimites.volumeMax}}mm)</span>
                {{else}}
                    <span class="tagPartie">{{_ "interface.objectif" }}: {{tr "interface.objectifs." objectif}} {{#if planete}}, {{_ "interface.planetes"}}: {{nomPlanete planete.planeteId}} {{/if}}</span>
                {{/if}}
            </div>
        </div>
        <div class="statsPartie">
            <ul>
                <li><span class="label">{{_ "interface.dateModif" }}</span>: <span class="info">{{formatDate dateModif "MM/DD/YYYY"}}</span></li>
                <li><span class="label">{{_ "interface.tpsTotal" }}</span>: <span class="info">{{ tempsTotal }}</span></li>
                {{#if finie }}
                <li><span class="label">{{_ "interface.finie" }}</span>: <span class="info">{{ score }}</span></li>
                {{/if}}
            </ul>
        </div>
    </div>
</template>
<template name="Partie">
    <div id="nomPartie">
        <h1 id="nomPartieView">{{ partie.nom }}</h1>
        <div id="nomPartieForm">
            <input type="text" id="nomPartieTxt" value="{{ partie.nom }}"/>
            <button id="nomPartieBouton">{{_ 'interface.bouton.ok' }}</button>
        </div>    
    </div>
    {{> PartieHeader partie=partie }}	
    <div id="plateau">
    	{{> Template.dynamic template=partieTemplate data=partieData}}
    </div>
</template>
<template name="PartieHeader">
    <nav class="navPartieMenu">
        <ul>
            <li><button id="partieScenario" class="image" title="{{_ 'interface.bouton.scenario'}}" ></button></li>
            <li><button id="partieLanceur" class="image" title="{{_ 'interface.bouton.lanceur'}}" ></button></li>
            {{#if hasLanceur }}
            {{#unless partie.cubesat}}<li><button id="partieOrbite" class="image" title="{{_ 'interface.bouton.orbite'}}" ></button></li>{{/unless}}
            <li><button id="partieMagasin" class="image" title="{{_ 'interface.bouton.magasin'}}" ></button></li>
            <li><button id="partieCollaboration" class="image" title="{{_ 'interface.bouton.collaboration'}}" ></button></li>
            <li><button id="partieExpertise" class="image" title="{{_ 'interface.bouton.expertise'}}" ></button></li>
            <li><button id="partieLancement" class="image" title="{{_ 'interface.bouton.lancement'}}" ></button></li>
            {{/if}}
        </ul>
    </nav>
    <nav class="navPartieConstantes">
        <ul>
            <li><button id="partieBudget" class="iconeConstante {{getIconeConstante 'euro-rd' partie.deck.budgetMax partie.deck.budget}}" title="{{_ 'interface.bouton.constanteBudget' }}"></button><span id="partieBudgetConstante" class="partieConstante">{{convertir partie.deck.budget 'EUR'}}</span></li>
            <li><button id="partieEnergie" class="iconeConstante {{getIconeConstante 'nrj-rd' partie.deck.energieMax partie.deck.energie}}" title="{{_ 'interface.bouton.constanteEnergie' }}"></button><span id="partieEnergieConstante" class="partieConstante">{{ partie.deck.energie }}</span></li>
            <li><button id="partiePoids" class="iconeConstante {{getIconeConstante 'Kg-rd' partie.deck.poidsMax partie.deck.masse}}" title="{{_ 'interface.bouton.constantePoids' }}"></button><span id="partiePoidsConstante" class="partieConstante">{{ partie.deck.masse }}</span></li>
            <li><button id="partieVolume" class="iconeConstante {{getIconeConstante 'cm-rd' partie.deck.volumeMax partie.deck.volume}}" title="{{_ 'interface.bouton.constanteVolume' }}"></button><span id="partieVolumeConstante" class="partieConstante">{{ partie.deck.volume }}</span></li>
            <li><button id="partieScience" class="iconeConstante star-rd4" title="{{_ 'interface.bouton.constanteScience' }}"></button><span id="partieScienceConstante" class="partieConstante">{{ partie.deck.science }}</span></li>
            {{#if hasLanceur }}
            <li><span id="percentLanceur" class="partieConstante">{{multi100 partie.budgetLanceur }}%</span></li>
            <li id="percentLanceurModal"><input id="partiePctLanceur" type="range" min="10" max="100" step="10" value="{{multi100 partie.budgetLanceur }}"/></li>
            {{/if}}
        </ul>
    </nav>

</template>

<template name="PartieLanceur">
    {{#each cartes}}
        {{> Carte }}
    {{/each}}
</template>
<template name="PartieOrbite">
    {{#each cartes}}
        {{> Carte }}
    {{/each}}
</template>
<template name="PartieCategorie">
    {{#each cartes}}{{> Carte }}{{/each}}
</template>
<template name="PartieCategories">
    {{#each categories}}
    {{#if nbrCartesTotal this}}
    <div class="partieCategorie" data-categorie="{{this}}"><!--
        --><div class="partieCategorieIcone {{this}}"></div><!--
        --><div class="partieCategorieLabel"><span>{{concat "categories." this }}</span><span class="stat">({{nbrCartesSelect this}} / {{nbrCartesTotal this}})</span></div><!--
    --></div>
    {{/if}}
    {{/each}}
</template>
<template name="Carte">
    <div id="{{carteId}}" class="carte {{isDeck}}" data-carteId="{{ carteId }}" ><!--
        --><div class="carteIntitule {{ categorie }}"><div class="intitule"><span>{{ intitule.fr }}</span></div><div class="carteId">{{ carteId }}</div></div><!--
        --><div class="carteIllustration"><img src="{{illustration carteId cubesat}}" /></div><!--
        --><div class="carteDescription">{{ description.fr }}</div><!--
        --><div class="carteConstantes {{ categorie }}">
          {{#if valEur}}<div class="carteConstante"><!--
            --><div class="carteConstanteBudget"></div><!--
            --><div class="carteConstanteValeur"><span>{{ valEur }}</span></div><!--
            --><div class="carteConstanteFin"></div><!--
          --></div>{{/if}}
          {{#if valPds}}<div class="carteConstante"><!--
            --><div class="carteConstanteMasse"></div><!--
            --><div class="carteConstanteValeur"><span>{{ valPds }}</span></div><!--
            --><div class="carteConstanteFin"></div><!--
          --></div>{{/if}}
          {{#if valVol}}<div class="carteConstante"><!--
            --><div class="carteConstanteVolume"></div><!--
            --><div class="carteConstanteValeur"><span>{{ valVol }}</span></div><!--
            --><div class="carteConstanteFin"></div><!--
          --></div>{{/if}}
          {{#if valNrg}}<div class="carteConstante"><!--
            --><div class="carteConstanteEnergie"></div><!--
            --><div class="carteConstanteValeur"><span>{{ valNrg }}</span></div><!--
            --><div class="carteConstanteFin"></div><!--
          --></div>{{/if}}
          {{#if valSci}}<div class="carteConstante"><!--
            --><div class="carteConstanteScience"></div><!--
            --><div class="carteConstanteValeur"><span>{{ valSci }}</span></div><!--
            --><div class="carteConstanteFin"></div><!--
          --></div>{{/if}}    
        </div>
        {{#if tip.fr }}<div class="carteTips">{{ tip.fr }}</div>{{/if}}
    </div>
</template>
<template name="PartieExpertiseConfirmation">
    <h2>{{_ "interface.expertise.appelExpert" }}</h2>
    <p>{{_ "interface.expertise.appelExpertDescription" }}</p>
    <ul>
        <li>{{_ "interface.scenario.nbrMaxExperts" }}: {{ scenario.expertise.nbrMaxExperts }}</li>
        <li>{{_ "interface.scenario.malusTemps" }}: {{ scenario.expertise.malusTemps }}</li>
        <li>{{_ "interface.scenario.malusBudget" }}: {{ scenario.expertise.malusBudget }}</li>
        <li>{{_ "interface.scenario.malusNbrEvenements" }}: {{ scenario.expertise.malusNbrEvenements }}</li>
        <li>{{_ "interface.scenario.nbrExpertsGratuits" }}: {{ scenario.expertise.nbrExpertsGratuits }}</li>
        <li>{{_ "interface.expertise.nbrExpertsAppeles" }}: {{nbrExpertsAppeles}}</li>
        <li>{{_ "interface.scenario.niveauDetails"}}: {{concat "interface.scenario.niveauDetails" scenario.expertise.niveauDetails }}</li>
    </ul>
    <div class="toolbarForm">
        <ul>
            <li><button id="appelExpert">{{_ "interface.bouton.appelExpert" }}</button></li>
            {{#if rapportExiste}}<li><button id="dernierExpert">{{_ "interface.bouton.dernierExpert" }}</button></li>{{/if}}
        </ul>
    </div>
</template>
<template name="PartieExpertiseRapport">
    <!-- revoir validation de deck : 1) modifier niveau détail 2 :obtenir les cartes , 2) sauver dans partie ) faire l'affichage -->
    <ul class="rapport">
    {{#if erreurs._ }}
        {{#each erreurs._}}
        <li>{{concat "validation." constante }}</li>
        {{/each}}
    {{/if}}
    {{#if niveauDetailsCategorie }}
        {{#each erreurs.categories }}
        <li><button class="categorieLien" data-categorieId="{{this}}">{{concat "categories." this }}</button></li>
        {{/each}}
    {{/if}}
    {{#if niveauDetailsCartes }}
        {{#each erreurs.cartes }}
        {{#if tag }}
        <li>{{_ "interface.rapport.tag" }}

            <ul>{{#each cartes }}
                <li><button class="carteLien" data-categorieId="{{categorie}}" data-carteId="{{carteId}}" >{{carteId}} {{intitule.fr}}</button></li>
                {{/each}}
            </ul>
        </li>
        {{/if}}
        {{#if incompatible }}
        <li>{{_ "interface.rapport.incompatible" }} <button class="carteLien" data-carteId="{{carteId}}" >{{carte.carteId}} {{carte.intitule.fr}}</button></li>
        {{/if}}
        {{#if necessite }}
        <li>{{_ "interface.rapport.necessite" }} <button class="carteLien" data-carteId="{{carteId}}" >{{carte.carteId}} {{carte.intitule.fr}}</button></li>
        {{/if}}
        
       {{/each}} 
       
    {{/if}}
    </ul>
    <div class="toolbarForm">
        <ul>
            <li><button id="appelExpertConfirmation">{{_ "interface.bouton.appelExpert" }}</button></li>
        </ul>
    </div>
</template>
<template name="PartieCollaborationConfirmation">
    <h2>{{_ "interface.collaboration.appelPeer" }}</h2>
    <p>{{_ "interface.collaboration.appelPeerDescription" }}</p>
    <ul>
        <li>{{_ "interface.scenario.nbrMaxAppels" }}: {{ scenario.collaboration.nbrMaxAppels }}</li>
        <li>{{_ "interface.scenario.malusTemps" }}: {{ scenario.collaboration.malusTemps }}</li>
        <li>{{_ "interface.scenario.malusBudget" }}: {{ scenario.collaboration.malusBudget }}</li>
        <li>{{_ "interface.scenario.malusNbrEvenements" }}: {{ scenario.collaboration.malusNbrEvenements }}</li>
        <li>{{_ "interface.scenario.nbrAppelsGratuits" }}: {{ scenario.collaboration.nbrAppelsGratuits }}</li>
        <li>{{_ "interface.scenario.tpsMaxParAppel"}}: {{ scenario.collaboration.tpsMaxParAppel }}</li>
        <li>{{_ "interface.collaboration.nbrPeersAppeles" }}: {{nbrPeersAppeles}}</li>
    </ul>
    <div class="toolbarForm">
        <ul>
            <li>{{> inputAutocomplete settings=settings id="peer" placeholder="..." }} <button id="appelPeer">{{_ "interface.bouton.appelPeer" }}</button></li>
            {{#if messageExiste}}<li><button id="messages">{{_ "interface.bouton.messages" }}</button></li>{{/if}}
        </ul>
    </div>
</template>
<template name="PartieCollaborationMessages">
     <h2>{{_ "interface.collaboration.messages" }}</h2>
     <div class="messages">
        {{#each messageItems}}
            {{#if message}}
        <div class="message">
            <div class="messageHeader"><span class="date">{{formatDate date "MM/DD/YYYY hh:mm"}}</span><span class="sujet">{{concat "interface.collaboration." typeItem}} {{pair.firstname}} {{pair.lastname}} ({{pair.username}})</span></div>
            <div class="messageAvatar"><img id="avatarMinified" src="{{#if pair.avatar}} {{pair.avatar}} {{else}} /defaultAvatar.png {{/if}}"/></div>
            <div class="messageTexte">{{message}}</div>
        </div>    
            {{else}}
        <div class="{{ typeItem }}"><span class="date">{{formatDate date "MM/DD/YYYY hh:mm"}}</span><span class="sujet">{{concat "interface.collaboration." typeItem}} {{pair.firstname}} {{pair.lastname}} ({{pair.username}})</span></div>    
            {{/if}}
        {{/each}}
     </div>
</template>
<template name="UserAutoComplete">
    ({{username}}) {{profile.firstname}} {{profile.lastname}}
</template>



